"use strict";(self.webpackChunkfornt_end=self.webpackChunkfornt_end||[]).push([[469],{469:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var i=a(43),r=a(799),s=a(276),c=a(334),d=a(579);const n=function(e){let{name_product:t,image_product:a,stock_product:r,product_price:n,product_details:o,product_id:l}=e;const[u,p]=(0,i.useState)(0),[h,m]=(0,i.useState)(""),[g,v]=(0,i.useState)(null),[x,j]=(0,i.useState)(0),[f,_]=(0,i.useState)(null),[w,N]=(0,i.useState)(""),[b,S]=(0,i.useState)(null);return(0,i.useEffect)((()=>{(async()=>{try{const e=await fetch("https://api.devsite.cfd/auth/user",{credentials:"include"}),t=await e.json();t.user?(v(t.user.id),_(t.user.profile_picture)):alert("Nu e\u0219ti autentificat")}catch(e){console.error("Eroare:",e)}})()}),[]),(0,i.useEffect)((()=>{g&&fetch(`https://api.devsite.cfd/orders_fetch/${g}`,{credentials:"include"}).then((e=>e.json())).then((e=>N(e))).catch((e=>console.log("Eroare la obtinerea comenzilor",e)))}),[g]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.A,{}),(0,d.jsxs)("div",{className:"productPage-main",children:[(0,d.jsx)("div",{className:"productPage-productTitle",children:(0,d.jsx)("h1",{children:t})}),(0,d.jsxs)("div",{className:"image_cartinfo-div",children:[(0,d.jsx)("div",{className:"product-page-image",children:(0,d.jsx)("img",{src:a,alt:t})}),(0,d.jsxs)("div",{className:"cartinfo-prodcut-page",children:[(0,d.jsx)("p",{className:"product-page-stock "+(r>0?"disponibil":"indisponibil"),children:r>0?"In stoc":"Stoc epuizat"}),(0,d.jsxs)("p",{className:"product-page-price",children:["Pre\u021b: $",n]}),(0,d.jsx)("button",{className:"product-page-cart-button",children:"Adaug\u0103 \xeen co\u0219"})]})]}),(0,d.jsxs)("div",{className:"product-page-details",children:[(0,d.jsx)("h2",{children:"Detalii"}),(0,d.jsx)("p",{children:o||"Nu sunt detalii disponibile."})]}),(0,d.jsxs)("div",{className:"product-page-reviews-description-div",children:[(0,d.jsx)("h2",{children:"Recenzii"}),(0,d.jsxs)("div",{className:"product-page-star-reviews-div",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h3",{children:"Adaug\u0103 o not\u0103"})}),(0,d.jsx)("div",{children:[1,2,3,4,5].map((e=>(0,d.jsx)("span",{onClick:()=>p(e),onMouseEnter:()=>j(e),onMouseLeave:()=>j(0),style:{fontSize:"24px",cursor:"pointer",color:e<=(x||u)?"gold":"grey"},children:"\u2605"},e)))})]}),(0,d.jsxs)("div",{className:"product-page-details-div",children:[(0,d.jsx)("textarea",{className:"product-page-input-details-div "+(h.length>500?"active1":""),onChange:e=>m(e.target.value),placeholder:"Descrie experien\u021ba ta cu produsul"}),(0,d.jsx)("p",{className:"char-limit-details-div "+(h.length>500?"active":""),children:"Ai dep\u0103\u0219it num\u0103rul maxim de caractere (500)!"})]}),(0,d.jsxs)("div",{className:"product-page-reviews-image-div",children:[(0,d.jsx)("div",{className:"product-page-reviews-image-div-text",children:(0,d.jsx)("p",{children:"Adaug\u0103 o imagine"})}),(0,d.jsx)("input",{type:"file",onChange:e=>{const t=e.target.files[0];t&&S(t)},accept:"image/*"}),b&&(0,d.jsxs)("p",{style:{fontSize:"14px"},children:["Imagine selectat\u0103: ",b.name]})]}),(0,d.jsx)("div",{className:"product-page-reviews-button-div",children:(0,d.jsx)("button",{onClick:async()=>{if(!l||!g)return alert("Nu exist\u0103 user_id sau product_id!");if(!u||!h)return alert("Campurile not\u0103 \u0219i descriere sunt obligatorii!");if(!w.some((e=>e.product_name===t)))return alert("Nu ai cump\u0103rat acest produs!");let e="";if(b){const t=new FormData;t.append("file",b);try{const a=await fetch("https://api.devsite.cfd/upload-image",{method:"POST",body:t});e=(await a.json()).url}catch(i){return console.error("\u274c Eroare la upload imagine:",i),void alert("Eroare la urcarea imaginii.")}}const a=new FormData;a.append("review_stars",u),a.append("description",h),a.append("profile_picture",f||""),a.append("image_url",e);try{const e=await fetch(`https://api.devsite.cfd/reviews_approval/${l}/${g}`,{method:"POST",body:a});if(!e.ok)throw new Error("Eroare la ad\u0103ugarea review-ului");await e.json();alert("\u2705 Review trimis cu succes!")}catch(i){console.error("\u274c",i),alert("Eroare la trimiterea review-ului.")}},children:"Trimite"})})]})]}),(0,d.jsx)(c.A,{})]})},o=()=>{const{name:e}=(0,r.g)(),[t,a]=(0,i.useState)(null);return(0,i.useEffect)((()=>{e&&fetch(`https://api.devsite.cfd/products/${e}`).then((e=>e.json())).then((e=>{console.log("Datele primite:",e),a(e)})).catch((e=>console.log("Eroare la obtinerea datelor produsului",e)))}),[e]),t?(0,d.jsx)(n,{name_product:t.name,image_product:t.image_url,stock_product:t.stock,product_price:t.price,product_details:t.product_details,product_id:t.id},t.id):(0,d.jsx)("h2",{children:"Se \xeencarc\u0103 produsul..."})}}}]);
//# sourceMappingURL=469.3308d415.chunk.js.map